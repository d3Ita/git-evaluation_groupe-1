#!/usr/bin/env python3
"""Minitrice - Calculatrice arithmétique élémentaire."""

import sys
import re

def parse_expression(expression):
    """Valide et parse une expression arithmétique avec regex."""
    expr = expression.strip()

    if not expr:
        raise SyntaxError("Expression vide")

    # Regex : nombre positif (opérateur) nombre positif
    pattern = r'^(\d+(\.\d+)?)\s*([+\-*/])\s*(\d+(\.\d+)?)$'
    match = re.match(pattern, expr)

    if not match:
        raise SyntaxError(expr)

    a = float(match.group(1))
    op = match.group(3)
    b = float(match.group(4))

    return a, op, b


def compute(expression):
    """Calcule le résultat d'une expression arithmétique."""
    a, op, b = parse_expression(expression)

    if op == '+':
        return a + b
    elif op == '-':
        return a - b
    elif op == '*':
        return a * b
    elif op == '/':
        if b == 0:
            raise ZeroDivisionError()
        return a / b


def format_result(result):
    """Formate le résultat pour l'affichage."""
    if result == int(result):
        return str(int(result))
    return str(result)


def main():
    interactive = sys.stdin.isatty()

    try:
        while True:
            if interactive:
                print("> ", end="", flush=True)

            line = input()

            if not line.strip():
                continue

            try:
                result = compute(line)
                print(format_result(result))
            except SyntaxError:
                print(f'Erreur de syntaxe pour le calcul: "{line.strip()}"')
            except ZeroDivisionError:
                print("Division par zéro")

    except EOFError:
        if interactive:
            print()
            print("Fin des calculs :)")

    sys.exit(0)


if __name__ == "__main__":
    main()
